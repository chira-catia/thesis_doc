\chapter{Application Architecutre}
\label{chapter:arch}

\section{Linux Kernel Library}
Here i should make a reference to tavi's thesis\cite{thesis}
\label{sec:lkl}

\subsection{Network driver}
\label{sec:net-driver}

The network driver is split into two separate parts: a LKL part and a native part.

The lkl part takes care of the interaction with the lkl kernel. It encapsulates
and decapsulates the packets for the kernel(encapsulates them in a struct sk_buff)
and the native part.

The native part uses native syscalls to assure communication between two devices.
It can use any inter-process communication primitives like pipes, mail queues, sockets
, etc... For this implementation I have chosen to use sockets so that it will be possible
to connect two devices on different computers.

\fig[scale=0.5]{src/img/driver.pdf}{img:eth-driver}{Network driver}

\section{LKL-net}
\label{sec:lkl-net}

\fig[scale=0.5]{src/img/arch.png}{img:lkl-net-arch}{LKL-net architecture}

\section{Devices}
\label{sec:devices}
The purpose of \project was to simulate several network devices -routers, switches, firewalls, nats- , but taking into account the fact that we wanted the LKL dvices to be able to communicate with non-LKL processes, we were faced with the need to implement some non-LKL devices to serve this purpose and these are hub and bridge devices. Following is a brief description of these devices, implementation details being discussed in a separate section,  \chapref{chapter:impl}-Implementation.
\subsection{Router}
\label{sub-sec:router}
\cite{linnetarch}
\subsection{Switch}
\label{sub-sec:switch}

\subsection{Firewall}
\label{sub-sec:firewall}

\subsection{NAT}
\label{sub-sec:nat}

\subsection{Auxiliar devices}
\label{sub-sec:auxdev}

\subsubsection{Hub}

\subsubsection{Bridge}

\section{Hypervisor}
\label{sub-sec:hypervisor}
